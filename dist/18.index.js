export const __webpack_esm_id__=18;export const __webpack_esm_ids__=[18];export const __webpack_esm_modules__={8018:(e,r,i)=>{i.d(r,{MlKem1024:()=>o,MlKem512:()=>l,MlKem768:()=>b});var t=i(38619),a=i(24220);class n{constructor(){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"auth",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}async serializePublicKey(e){try{return await this._serializePublicKey(e)}catch(e){throw new a.LV(e)}}async deserializePublicKey(e){try{return await this._deserializePublicKey(e)}catch(e){throw new a.Ug(e)}}async serializePrivateKey(e){try{return await this._serializePrivateKey(e)}catch(e){throw new a.LV(e)}}async deserializePrivateKey(e){try{return await this._deserializePrivateKey(e)}catch(e){throw new a.Ug(e)}}async generateKeyPair(){await this._setup();const e=new Uint8Array(32),r=new Uint8Array(32);try{this._api.getRandomValues(e),this._api.getRandomValues(r)}catch(e){throw new a.EM(e)}try{const i=(0,a.xW)(e,r),[t,n]=await this._prim.deriveKeyPair(i);return{privateKey:await this.deserializePrivateKey(i.buffer),publicKey:await this.deserializePublicKey(t.buffer)}}catch(e){throw new a.$7(e)}}async deriveKeyPair(e){try{const[r,i]=await this._prim.deriveKeyPair(new Uint8Array(e));return{privateKey:await this.deserializePrivateKey(e),publicKey:await this.deserializePublicKey(r.buffer)}}catch(e){throw new a.$7(e)}}async importKey(e,r,i=!0){await this._setup();try{let t;if("jwk"===e){if(r instanceof ArrayBuffer||r instanceof Uint8Array)throw new Error("Invalid jwk key format");t=await this._importJWK(r,i)}else if(r instanceof ArrayBuffer)t=new Uint8Array(r);else{if(!(r instanceof Uint8Array))throw new Error("Invalid key format");t=r}if(i&&t.byteLength!==this.publicKeySize)throw new Error("Invalid length of the key");if(!i&&t.byteLength!==this.privateKeySize)throw new Error("Invalid length of the key");return new a.Bk(this.name,t,i?"public":"private",i?[]:a.xE)}catch(e){throw new a.Ug(e)}}async encap(e){let r;if(void 0!==e.ekm)if(e.ekm instanceof ArrayBuffer)r=new Uint8Array(e.ekm);else{if(!(e.ekm instanceof Uint8Array))throw new a.NS("ekm must be 32 bytes in length");r=e.ekm}const i=new Uint8Array(await this.serializePublicKey(e.recipientPublicKey));if(i.byteLength!==this.publicKeySize)throw new a.NS("Invalid length of recipientKey");try{const[e,t]=await this._prim.encap(i,r);return{sharedSecret:t.buffer,enc:e.buffer}}catch(e){throw new a.Wg(e)}}async decap(e){const r=(0,a.Di)(e.recipientKey)?e.recipientKey.privateKey:e.recipientKey;if(e.enc.byteLength!==this.encSize)throw new a.NS("Invalid length of enc");const i=new Uint8Array(e.enc),t=new Uint8Array(await this.serializePrivateKey(r));if(t.byteLength!==this.privateKeySize)throw new a.NS("Invalid length of recipientKey");try{const[e,r]=await this._prim.deriveKeyPair(t);return(await this._prim.decap(i,r)).buffer}catch(e){throw new a.uu(e)}}async _setup(){void 0===this._api&&(this._api=await(0,a.QZ)())}_serializePublicKey(e){return new Promise((r,i)=>{"public"!==e.type&&i(new Error("Not public key")),e.algorithm.name!==this.name&&i(new Error(`Invalid algorithm name: ${e.algorithm.name}`)),e.key.byteLength!==this.publicKeySize&&i(new Error(`Invalid key length: ${e.key.byteLength}`)),r(e.key.buffer)})}_deserializePublicKey(e){return new Promise((r,i)=>{e.byteLength!==this.publicKeySize&&i(new Error(`Invalid key length: ${e.byteLength}`)),r(new a.Bk(this.name,new Uint8Array(e),"public"))})}_serializePrivateKey(e){return new Promise((r,i)=>{"private"!==e.type&&i(new Error("Not private key")),e.algorithm.name!==this.name&&i(new Error(`Invalid algorithm name: ${e.algorithm.name}`)),e.key.byteLength!==this.privateKeySize&&i(new Error(`Invalid key length: ${e.key.byteLength}`)),r(e.key.buffer)})}_deserializePrivateKey(e){return new Promise((r,i)=>{e.byteLength!==this.privateKeySize&&i(new Error(`Invalid key length: ${e.byteLength}`)),r(new a.Bk(this.name,new Uint8Array(e),"private",["deriveBits"]))})}_importJWK(e,r){return new Promise((i,t)=>{void 0!==e.kty&&"AKP"===e.kty||t(new Error(`Invalid kty: ${e.kty}`)),void 0!==e.alg&&e.alg===this.name||t(new Error(`Invalid alg: ${e.alg}`)),r||(void 0===e.priv&&t(new Error("Invalid key: `priv` not found")),void 0===e.key_ops||1===e.key_ops.length&&"deriveBits"===e.key_ops[0]||t(new Error("Invalid key: `key_ops` should be ['deriveBits']")),i((0,a.rf)(e.priv))),void 0!==e.priv&&t(new Error("Invalid key: `priv` should not be set")),void 0===e.pub&&t(new Error("Invalid key: `pub` not found")),void 0!==e.key_ops&&e.key_ops.length>0&&t(new Error("Invalid key: `key_ops` should not be set")),i((0,a.rf)(e.pub))})}}class l extends n{constructor(){super(),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:a.h.MlKem512}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ML-KEM-512"}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:768}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:800}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"auth",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._prim=new t.Zc}}class b extends n{constructor(){super(),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:a.h.MlKem768}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ML-KEM-768"}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:1088}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:1184}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"auth",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._prim=new t.wo}}class o extends n{constructor(){super(),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:a.h.MlKem1024}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ML-KEM-1024"}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:1568}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:1568}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"auth",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._prim=new t.AL}}}};